<?php

// -----------------------------------------------------------------------------------------------------------------#
// ---------------------------------------Archivos necesarios Require Include---------------------------------------#
// -----------------------------------------------------------------------------------------------------------------#
require_once FOLDER_MODEL_EXTEND. "model.medio_enterar.inc.php";
// -----------------------------------------------------------------------------------------------------------------#
// --------------------------------------------Inicializacion de control--------------------------------------------#
// -----------------------------------------------------------------------------------------------------------------#

// -----------------------------------------------------------------------------------------------------------------#
// -----------------------------------------------------------------------------------------------------------------#

// -----------------------------------------------------------------------------------------------------------------#
// ----------------------------------------------------Funciones----------------------------------------------------#
// -----------------------------------------------------------------------------------------------------------------#

// -----------------------------------------------------------------------------------------------------------------#
// -----------------------------------------------------------------------------------------------------------------#

// -----------------------------------------------------------------------------------------------------------------#
// ---------------------------------------------------Seccion AJAX--------------------------------------------------#
// -----------------------------------------------------------------------------------------------------------------#

$xajax = new xajax();


function verMedios($mes, $anio){
    $r=new xajaxResponse();
    
    $medios = new ModeloMedio_enterar();
    $txt="";
    $totales = $medios->obtenerTotalMedios($mes, $anio);
        $txt.='<div class="row">
					<div class="12u 12u$(small)">
						<h4>Medios</h4>
					</div>';
        foreach ($totales as $nombre=>$info){
                $color="#22AA11";
            $txt.='<div class=" row 12u 12u$(small)">
                     <div class="4u 12u$(small)">
						<label>'.$nombre.' '.(round($info[1],2)*10).'% ('.$info[0].')</label>
					</div>
					<div class="5u 12u$(small)">
                        <div class="barra">
                          <span style="width: '.round($info[1]*10).'%;  background-color:'.$color.'"></span>
                        </div>
					</div> </div>';
        }
        $txt.="</div>";
 /*   
    if (count($arrInfo)>0){
        $txtComen="<ul>";
        $arrComentarios = $medios->obtenerComentarios($mes, $anio);
        foreach ($arrComentarios as $comentario){
            $txtComen.="<li>$comentario</li>";
        }
        $txtComen.="</ul>";
        $r->assign("comen", "innerHTML", $txtComen);
    }
 */   
    $r->assign("divEvalua", "innerHTML", $txt);
    
    return $r;
    
}

$xajax->registerFunction("verMedios");

$xajax->processRequest();


// -----------------------------------------------------------------------------------------------------------------#
// -------------------------------------------Inicializacion de variables-------------------------------------------#
// -----------------------------------------------------------------------------------------------------------------#
$mes=date("m");
$anio=date("Y");
$anioI=2021;

$meses =  array (
    "01"=>"Enero",
    "02"=>"Febrero",
    "03"=>"Marzo",
    "04"=>"Abril",
    "05"=>"Mayo",
    "06"=>"Junio",
    "07"=>"Julio",
    "08"=>"Agosto",
    "09"=>"Septiembre",
    "10"=>"Octubre",
    "11"=>"Noviembre",
    "12"=>"Diciembre"
);
$comboAnio=$comboMeses="";
foreach ($meses as $key => $opcion)
    $comboMeses.='<option value="'.$key.'" '.($key==$mes?' selected ':'').'>'.$opcion.'</option>';
    for ($a=$anioI;$a<=$anio;$a++)
        $comboAnio.='<option value="'.$a.'" '.($a==$anio?' selected ':'').'>'.$a.'</option>';
        
?>