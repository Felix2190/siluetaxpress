<?php

// -----------------------------------------------------------------------------------------------------------------#
// ---------------------------------------Archivos necesarios Require Include---------------------------------------#
// -----------------------------------------------------------------------------------------------------------------#
require_once FOLDER_MODEL_EXTEND. "model.encuesta.inc.php";
// -----------------------------------------------------------------------------------------------------------------#
// --------------------------------------------Inicializacion de control--------------------------------------------#
// -----------------------------------------------------------------------------------------------------------------#

// -----------------------------------------------------------------------------------------------------------------#
// -----------------------------------------------------------------------------------------------------------------#

// -----------------------------------------------------------------------------------------------------------------#
// ----------------------------------------------------Funciones----------------------------------------------------#
// -----------------------------------------------------------------------------------------------------------------#

// -----------------------------------------------------------------------------------------------------------------#
// -----------------------------------------------------------------------------------------------------------------#

// -----------------------------------------------------------------------------------------------------------------#
// ---------------------------------------------------Seccion AJAX--------------------------------------------------#
// -----------------------------------------------------------------------------------------------------------------#

$xajax = new xajax();


function guardar($idEncuesta, $personal, $evalua, $opinion, $personalR, $evaluaR){
    $r=new xajaxResponse();
    $fecha = date("Y-m-d H:i:s");
    
    $encuesta = new ModeloEncuesta();
    $encuesta->setIdEncuesta($idEncuesta);
    
    $encuesta->setIdPersonal($personal);
    $encuesta->setEvaluacion($evalua);
    $encuesta->setOpinion($opinion);
    $encuesta->setIdPersonalRecepcion($personalR);
    $encuesta->setEvaluacionRecepcion($evaluaR);
    $encuesta->setEstatus();
    $encuesta->setFechaRegistro($fecha);
    $encuesta->Guardar();
    if ($encuesta->getError()){
        $r->call("mostrarMsjError","Ocurri&oacute; un error, int&eacute;ntelo m&aacute;s tarde! ",5);
        return $r;
    }
    $r->call("mostrarMsjExito","Hemos registrado correctamente tus respuestas, muchas gracias por dejarnos su opini&oacute;n");
    $r->redirect("encuesta",3);
    return $r;
    
}

$xajax->registerFunction("guardar");

$xajax->processRequest();


// -----------------------------------------------------------------------------------------------------------------#
// -------------------------------------------Inicializacion de variables-------------------------------------------#
// -----------------------------------------------------------------------------------------------------------------#
?>