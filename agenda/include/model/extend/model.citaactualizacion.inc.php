<?php

	require FOLDER_MODEL_BASE . "model.base.citaactualizacion.inc.php";

	class ModeloCitaactualizacion extends ModeloBaseCitaactualizacion
	{
		#------------------------------------------------------------------------------------------------------#
		#----------------------------------------------Propiedades---------------------------------------------#
		#------------------------------------------------------------------------------------------------------#
		var $_nombreClase="ModeloBaseCitaactualizacion";

		var $__ss=array();

		#------------------------------------------------------------------------------------------------------#
		#--------------------------------------------Inicializacion--------------------------------------------#
		#------------------------------------------------------------------------------------------------------#

		function __construct()
		{
			parent::__construct();
		}

		function __destruct()
		{
			
		}

		#------------------------------------------------------------------------------------------------------#
		#------------------------------------------------Setter------------------------------------------------#
		#------------------------------------------------------------------------------------------------------#



		#------------------------------------------------------------------------------------------------------#
		#-----------------------------------------------Unsetter-----------------------------------------------#
		#------------------------------------------------------------------------------------------------------#



		#------------------------------------------------------------------------------------------------------#
		#------------------------------------------------Getter------------------------------------------------#
		#------------------------------------------------------------------------------------------------------#



		#------------------------------------------------------------------------------------------------------#
		#------------------------------------------------Querys------------------------------------------------#
		#------------------------------------------------------------------------------------------------------#

		#------------------------------------------------------------------------------------------------------#
		#------------------------------------------------Otras-------------------------------------------------#
		#------------------------------------------------------------------------------------------------------#
		
		public function validarDatos()
		{
			return true;
		}

		public function obtenerCitas()
    {
        $query = "Select idActualizacion, DATE_FORMAT(fecha,'%Y-%m-%d') as fecha_, DATE_FORMAT(fecha,'%H:%i') as hora_, hora, ca.duracion, ca.tipo,
                    concat_ws(' ', u.nombre, u.apellidos) as nombre_usuario, cab.nombre as cabina, fechaCita from citaactualizacion as ca
                    inner join cita as c on ca.idCita=c.idCita
                    inner join usuario as u on ca.idUsuario=u.idUsuario
                    inner join cabina as cab on ca.idCabina=cab.idCabina
                    where ca.idCita=$this->idCita order by ca.fecha";
        
        $respuesta = array();
        $count = 1;
        $resultado = mysqli_query($this->dbLink, $query);
        if ($resultado && mysqli_num_rows($resultado) > 0) {
            while ($row_inf = mysqli_fetch_assoc($resultado)) {
                $respuesta[$row_inf['idActualizacion']] = $row_inf;
                $count ++;
            }
        }
        return $respuesta;
    }
		
	}

