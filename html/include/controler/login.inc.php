<?php

// -----------------------------------------------------------------------------------------------------------------#
// ---------------------------------------Archivos necesarios Require Include---------------------------------------#
// -----------------------------------------------------------------------------------------------------------------#
require_once FOLDER_MODEL_EXTEND. "model.login.inc.php";
// -----------------------------------------------------------------------------------------------------------------#
// --------------------------------------------Inicializacion de control--------------------------------------------#
// -----------------------------------------------------------------------------------------------------------------#

// -----------------------------------------------------------------------------------------------------------------#
// -----------------------------------------------------------------------------------------------------------------#

// -----------------------------------------------------------------------------------------------------------------#
// ----------------------------------------------------Funciones----------------------------------------------------#
// -----------------------------------------------------------------------------------------------------------------#

// -----------------------------------------------------------------------------------------------------------------#
// -----------------------------------------------------------------------------------------------------------------#

// -----------------------------------------------------------------------------------------------------------------#
// ---------------------------------------------------Seccion AJAX--------------------------------------------------#
// -----------------------------------------------------------------------------------------------------------------#

$xajax = new xajax();

function ingresar($user,$pass){
    $login=new ModeloLogin();
    $arrSesion=$login->validarUsuarioPassword(array('username'=>$user,'password'=>$pass));
    
    $r=new xajaxResponse();
    
    if (!$arrSesion[0]){
        $r->call('mostrarMsjError',$arrSesion[1],50);
        return $r;
    }
    
    $objSession=new clsSession();
    $objSession->updateTime();
    $objSession->setObjetoGetInfo($arrSesion[1]);
    $_SESSION['objSession']=serialize($objSession);
    $r->call('mostrarMsjExito','Datos correctos!',3);
    $r->redirect("agenda/index.php",3);
    return $r;
    
    
}
$xajax->registerFunction("ingresar");

$xajax->processRequest();


// -----------------------------------------------------------------------------------------------------------------#
// -------------------------------------------Inicializacion de variables-------------------------------------------#
// -----------------------------------------------------------------------------------------------------------------#
?>